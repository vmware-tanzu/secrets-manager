# VMware Secrets Manager (VSecM) Helm Chart

VMware Secrets Manager keeps your secrets secret. With VSecM, you can rest assured
that your sensitive data is always secure and protected. VSecM is perfect for
securely storing arbitrary configuration information at a central location and
securely dispatching it to workloads.

![Version: 0.25.4](https://img.shields.io/badge/Version-0.25.4-informational?style=flat-square) ![Type: application](https://img.shields.io/badge/Type-application-informational?style=flat-square) ![AppVersion: 0.25.4](https://img.shields.io/badge/AppVersion-0.25.4-informational?style=flat-square)

[![Artifact Hub](https://img.shields.io/endpoint?url=https://artifacthub.io/badge/repository/vsecm)](https://artifacthub.io/packages/helm/vsecm/vsecm)

## Quickstart

To use VMware Secrets Manager, follow the steps below:

1. Add VMware Secrets Manager Helm repository:

    ```bash
    helm repo add vsecm https://vmware-tanzu.github.io/secrets-manager/
    ```

2. Update the helm repository:

    ```bash
    helm repo update
    ```

3. Install VMware Secrets Manager using Helm:

    ```bash
    helm install vsecm vsecm/vsecm --version 0.22.4
    ```

## Options

The following options can be passed to the `helm install` command to set global
variables:

*`--set global.deploySpire=<true/false>`:
  This flag can be passed to install or skip SPIRE.
*`--set global.baseImage=<distroless|distroless-fips>`:
  This flag can be passed to install VSecM with the given baseImage Docker image.

Default values are `true` and `distroless` for `global.deploySpire`
and `global.baseImage` respectively.

Here's an example command with the above options:

```bash
helm install vsecm vsecm/helm-charts --version 0.22.4 \
  --set global.deploySpire=true --set global.baseImage=distroless
```

Make sure to replace `<true|false>` and
`<distroless|distroless-fips>` with the desired values.

## Environment Configuration

**VMware Secrets Manager** can be tweaked further using environment variables.

[Check out **Configuring VSecM** on the official documentation][configuring-vsecm]
for details.

These environment variable configurations are expose through subcharts.
You can modify them as follows:

```bash
helm install vsecm vsecm/helm-charts --version 0.22.0 \
--set safe.environments.VSECM_LOG_LEVEL="6"
--set sentinel.environments.VSECM_LOGL_LEVEL="5"
# You can update other environment variables too.
# Most of the time VSecM assumes sane defaults if you don't set them.
```

[configuring-vsecm]: https://vsecm.com/docs/configuration/

## License

This project is licensed under the [BSD 2-Clause License](https://github.com/vmware-tanzu/secrets-manager/blob/main/LICENSE).

## Detailed Documentation

The sections below are autogenerated from chart source code.

### Requirements

## Requirements

| Repository | Name | Version |
|------------|------|---------|
| file://charts/keystone | keystone | 0.25.4 |
| file://charts/safe | safe | 0.25.4 |
| file://charts/sentinel | sentinel | 0.25.4 |
| file://charts/spire | spire | 0.25.4 |

### Values

## Values

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| global.baseImage | string | `"distroless"` |  |
| global.deployKeystone | bool | `true` |  |
| global.deploySpire | bool | `true` | Deploy SPIRE components. If set to false, SPIRE components will not be deployed. This is useful when SPIRE is already deployed in the cluster. |
| global.images.initContainer.repository | string | `"vsecm-ist-init-container"` |  |
| global.images.initContainer.tag | string | `"0.25.4"` |  |
| global.images.keystone.distrolessFipsRepository | string | `"vsecm-ist-fips-keystone"` |  |
| global.images.keystone.distrolessRepository | string | `"vsecm-ist-keystone"` |  |
| global.images.keystone.pullPolicy | string | `"IfNotPresent"` |  |
| global.images.keystone.tag | string | `"0.25.4"` |  |
| global.images.nodeDriverRegistrar.pullPolicy | string | `"IfNotPresent"` |  |
| global.images.nodeDriverRegistrar.repository | string | `"registry.k8s.io/sig-storage/csi-node-driver-registrar"` |  |
| global.images.nodeDriverRegistrar.tag | string | `"v2.10.0"` |  |
| global.images.safe.distrolessFipsRepository | string | `"vsecm-ist-fips-safe"` |  |
| global.images.safe.distrolessRepository | string | `"vsecm-ist-safe"` |  |
| global.images.safe.pullPolicy | string | `"IfNotPresent"` |  |
| global.images.safe.tag | string | `"0.25.4"` |  |
| global.images.sentinel.distrolessFipsRepository | string | `"vsecm-ist-fips-sentinel"` |  |
| global.images.sentinel.distrolessRepository | string | `"vsecm-ist-sentinel"` |  |
| global.images.sentinel.pullPolicy | string | `"IfNotPresent"` |  |
| global.images.sentinel.tag | string | `"0.25.4"` |  |
| global.images.spiffeCsiDriver.pullPolicy | string | `"IfNotPresent"` |  |
| global.images.spiffeCsiDriver.repository | string | `"ghcr.io/spiffe/spiffe-csi-driver"` |  |
| global.images.spiffeCsiDriver.tag | string | `"0.2.6"` |  |
| global.images.spireAgent.pullPolicy | string | `"IfNotPresent"` |  |
| global.images.spireAgent.repository | string | `"ghcr.io/spiffe/spire-agent"` |  |
| global.images.spireAgent.tag | string | `"1.9.4"` |  |
| global.images.spireControllerManager.pullPolicy | string | `"IfNotPresent"` |  |
| global.images.spireControllerManager.repository | string | `"ghcr.io/spiffe/spire-controller-manager"` |  |
| global.images.spireControllerManager.tag | string | `"0.5.0"` |  |
| global.images.spireServer.pullPolicy | string | `"IfNotPresent"` |  |
| global.images.spireServer.repository | string | `"ghcr.io/spiffe/spire-server"` |  |
| global.images.spireServer.tag | string | `"1.9.4"` |  |
| global.logLevel | string | `"7"` |  |
| global.registry | string | `"vsecm"` |  |
| global.spire.logLevel | string | `"DEBUG"` |  |
| global.spire.namespace | string | `"spire-system"` |  |
| global.spire.serverPort | int | `8081` |  |
| global.spire.trustDomain | string | `"vsecm.com"` |  |
| global.vsecm.keystoneSpiffeIdTemplate | string | `"spiffe://vsecm.com/workload/vsecm-keystone/ns/{{ .PodMeta.Namespace }}/sa/{{ .PodSpec.ServiceAccountName }}/n/{{ .PodMeta.Name }}"` |  |
| global.vsecm.namespace | string | `"vsecm-system"` |  |
| global.vsecm.safeEndpointUrl | string | `"https://vsecm-safe.vsecm-system.svc.cluster.local:8443/"` |  |
| global.vsecm.safeSpiffeIdPrefix | string | `"spiffe://vsecm.com/workload/vsecm-safe/ns/vsecm-system/sa/vsecm-safe/n/"` |  |
| global.vsecm.safeSpiffeIdTemplate | string | `"spiffe://vsecm.com/workload/vsecm-safe/ns/{{ .PodMeta.Namespace }}/sa/{{ .PodSpec.ServiceAccountName }}/n/{{ .PodMeta.Name }}"` |  |
| global.vsecm.sentinelSpiffeIdPrefix | string | `"spiffe://vsecm.com/workload/vsecm-sentinel/ns/vsecm-system/sa/vsecm-sentinel/n/"` |  |
| global.vsecm.sentinelSpiffeIdTemplate | string | `"spiffe://vsecm.com/workload/vsecm-sentinel/ns/{{ .PodMeta.Namespace }}/sa/{{ .PodSpec.ServiceAccountName }}/n/{{ .PodMeta.Name }}"` |  |
| global.vsecm.useClusterSpiffeIds | bool | `true` |  |
| podAnnotations | object | `{}` |  |

