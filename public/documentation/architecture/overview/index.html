
<!DOCTYPE html>
<html lang="en-gb">
    <head>
        <meta charset="UTF-8">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="keep your secrets... secret">
        <meta name="author" content="VMware Secrets Manager Contributors">
        <title>VSecM Architecture | VMware Secrets Manager </title>
        <link rel="stylesheet" href="https://vsecm.com/site.css"/>
        <link rel="icon" href="https://vsecm.com/vsecm-32.png">
    </head>
    <body>

        <header style="background:#00151D;">
            <nav class="">
                <a class="header__logo white" href="https:&#x2F;&#x2F;vsecm.com&#x2F;" style="font-weight:100;color:#95e3fc;">
                    <img src="https://vsecm.com/vsecm-64.png" alt="VSecM" style="vertical-align:middle">
                    VMware Secrets Manager
                    <em style="font-size:0.62em;color:#ffffff">v0.28.0</em>
                </a>
                <a class="white" href="https://vsecm.com/documentation/" class="nav-link">
                <svg
                    style="position:relative;top:4px;"
                    xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="-0.375 -0.375 24 24" id="Programming-Book--Streamline-Ultimate" height="24" width="24"><desc>Programming Book</desc><path fill="#e3e3e3" d="M18.890625 4.359375v-2.90625a0.96875 0.96875 0 0 0 -0.96875 -0.96875h-12.59375a1.9375 1.9375 0 1 0 0 3.875h13.5625Z" stroke-width="0.75"></path><path fill="#ffef5e" d="M3.390625 2.421875a1.9375 1.9375 0 0 0 1.9375 1.9375h13.5625a0.96875 0.96875 0 0 1 0.96875 0.96875v16.46875a0.96875 0.96875 0 0 1 -0.96875 0.96875h-13.5625a1.9375 1.9375 0 0 1 -1.9375 -1.9375v-18.40625Z" stroke-width="0.75"></path><path fill="#fff9bf" d="M18.890625 4.359375h-13.5625a1.9375 1.9375 0 0 1 -1.9375 -1.9375v2.90625a1.9375 1.9375 0 0 0 1.9375 1.9375h13.5625a0.96875 0.96875 0 0 1 0.96875 0.96875v-2.90625a0.96875 0.96875 0 0 0 -0.96875 -0.96875Z" stroke-width="0.75"></path><path stroke="#191919" stroke-linecap="round" stroke-linejoin="round" d="M5.328125 2.421875h10.65625a0.96875 0.96875 0 0 1 0.96875 0.96875v0.96875" stroke-width="0.75"></path><path stroke="#191919" stroke-linecap="round" stroke-linejoin="round" d="M18.890625 4.359375v-2.90625a0.96875 0.96875 0 0 0 -0.96875 -0.96875h-12.59375a1.9375 1.9375 0 1 0 0 3.875h13.5625Zm0 0a0.96875 0.96875 0 0 1 0.96875 0.96875v16.46875a0.96875 0.96875 0 0 1 -0.96875 0.96875h-13.5625a1.9375 1.9375 0 0 1 -1.9375 -1.9375v-18.40625" stroke-width="0.75"></path><path stroke="#191919" stroke-linecap="round" stroke-linejoin="round" d="m7.265625 10.175749999999999 2.421875 2.421875 -2.421875 2.421875" stroke-width="0.75"></path><path stroke="#191919" stroke-linecap="round" stroke-linejoin="round" d="M12.109375 14.050749999999999h3.875" stroke-width="0.75"></path></svg>
                Docs

                </a>
                <a class="white" href=" https://join.slack.com/t/a-101-103-105-s/shared_invite/zt-287dbddk7-GCX495NK~FwO3bh_DAMAtQ" class="nav-link">
                    <svg
                        style="position:relative;top:6px;"
                        xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14" id="Slack-Logo--Streamline-Flex-Gradient" height="24" width="24" stroke-width="1"><desc>Slack Logo</desc><g id="slack"><path id="Union" fill="url(#paint0_linear_7718_2952)" fill-rule="evenodd" d="M5.75879.25c.41421 0 .75.335786.75.75v.24995c0 .41421-.33579.75-.75.75s-.75-.33579-.75-.75V1c0-.414214.33579-.75.75-.75ZM13 4.34033c.4142 0 .75.33579.75.75v.24995c0 .41422-.3358.75-.75.75s-.75-.33578-.75-.75v-.24995c0-.41421.3358-.75.75-.75ZM1.75 8.03479c0-.41421-.33579-.75-.75-.75-.414214 0-.75.33579-.75.75v.24995c0 .41421.335786.75.75.75.41421 0 .75-.33579.75-.75v-.24995Zm4.54094-4.46403c.23744.28178.38454.65583.38454 1.04404 0 .38821-.1471.76227-.38454 1.04404-.23628.2804-.58938.4986-1.01303.50949-1.1742.06477-2.45614.06477-3.63034 0-.42365-.01089-.776743-.22909-1.013025-.50949C.397098 5.37707.25 5.00301.25 4.6148c0-.38821.147099-.76226.384545-1.04404.236282-.28039.589375-.49859 1.013025-.50948 1.1742-.06478 2.45614-.06478 3.63034 0 .42365.01089.77675.22909 1.01303.50948ZM9.34332.25c-.38821 0-.76226.147099-1.04404.384545-.2804.236281-.4986.589375-.50949 1.013025-.06477 1.1742-.06477 2.45614 0 3.63034.01089.42365.22909.77675.50949 1.01303.28178.23744.65583.38454 1.04404.38454.38821 0 .76228-.1471 1.04408-.38454.2804-.23628.4986-.58938.5094-1.01303.0648-1.1742.0648-2.45614 0-3.63034-.0108-.42365-.229-.776743-.5094-1.013025C10.1056.397099 9.73153.25 9.34332.25ZM5.70084 13.3671c-.28178.2375-.65584.3846-1.04405.3846-.3882 0-.76226-.1471-1.04404-.3846-.28039-.2363-.49859-.5894-.50948-1.013-.06478-1.1742-.06478-2.45615 0-3.63036.01089-.42364.22909-.77674.50948-1.01302.28178-.23745.65584-.38455 1.04405-.38455.38821 0 .76226.1471 1.04404.38455.28039.23628.49859.58938.50948 1.01302.06478 1.17421.06478 2.45616 0 3.63036-.01089.4236-.22909.7767-.50948 1.013Zm1.62338-3.9802c0 .38821.1471.7623.38454 1.044.23628.2804.58938.4986 1.01303.5095 1.1742.0648 2.45611.0648 3.63031 0 .4237-.0109.7768-.2291 1.0131-.5095.2374-.2817.3845-.65579.3845-1.044 0-.38821-.1471-.76227-.3845-1.04404-.2363-.2804-.5894-.4986-1.0131-.50949-1.1742-.06477-2.45611-.06477-3.63031 0-.42365.01089-.77674.22909-1.01303.50949-.23744.28177-.38454.65583-.38454 1.04404Zm.85644 2.6148c.41422 0 .75.3358.75.75v.25c0 .4142-.33578.75-.75.75-.41421 0-.75-.3358-.75-.75v-.25c0-.4142.33579-.75.75-.75Z" clip-rule="evenodd"></path></g><defs><linearGradient id="paint0_linear_7718_2952" x1="14.92" x2="-3.291" y1="16.611" y2="3.677" gradientUnits="userSpaceOnUse"><stop stop-color="#ffd600"></stop><stop offset="1" stop-color="#FF007A"></stop></linearGradient></defs></svg>
                    Slack</a>
                <a class="white" href="https://github.com/vmware-tanzu/secrets-manager" class="nav-link">
                    <svg
                        style="position:relative;top:6px;"
                        xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="-0.375 -0.375 24 24" id="Github-Logo--Streamline-Ultimate" height="24" width="24"><desc>Github Logo</desc><path fill="#808080" d="M21.0912375 9.106250000000001L21.1230125 9.129015625000001S23.7510375 4.588096875000001 20.5270375 1.94118125C18.540615625 1.94118125 15.503390625 5.21885 15.503390625 5.21885L15.525284375 5.2347375C13.00004375 4.5066250000000005 10.321353125 4.5012 7.793109374999999 5.21885C7.776253125000001 5.20393125 4.75094375 1.94118125 2.7694625 1.94118125C-0.381978125 4.523578125 2.04541875 8.905621875 2.159634375 9.10915625C1.0598125 10.796428125 0.570884375 12.80939375 0.7741281250000001 14.81315625C1.01350625 17.918 3.6018125 21.30881875 6.715471875 21.30881875H16.533365625000002C19.647121875 21.30881875 22.236396875 17.918 22.474709375 14.81315625C22.680859375 12.808521875 22.192415625 10.793909374999998 21.0912375 9.106250000000001Z" stroke-width="0.75"></path><path fill="#b2b2b2" d="M1.09294375 11.432315625C4.235665625 9.4212875 7.895021874999999 8.366803124999999 11.62596875 8.397028125C15.356915625 8.36554375 19.016659375 9.4189625 22.159865625000002 11.4293125C21.926784375 10.603065625 21.566215625 9.81828125 21.0912375 9.103246875L21.1230125 9.126109375S23.7510375 4.5850937499999995 20.5270375 1.938275C18.540615625 1.938275 15.503390625 5.215846875 15.503390625 5.215846875L15.525284375 5.230765625C12.999656250000001 4.50449375 10.3210625 4.500425 7.793109374999999 5.21885C7.776253125000001 5.20393125 4.75094375 1.94118125 2.7694625 1.94118125C-0.381978125 4.523578125 2.04541875 8.905621875 2.159634375 9.10915625C1.68581875 9.8239 1.3259281250000001 10.60800625 1.09294375 11.433284375Z" stroke-width="0.75"></path><path stroke="#191919" stroke-linecap="round" stroke-linejoin="round" d="M21.0912375 9.106250000000001L21.1230125 9.129015625000001S23.7510375 4.588096875000001 20.5270375 1.94118125C18.540615625 1.94118125 15.503390625 5.21885 15.503390625 5.21885L15.525284375 5.2347375C13.00004375 4.5066250000000005 10.321353125 4.5012 7.793109374999999 5.21885C7.776253125000001 5.20393125 4.75094375 1.94118125 2.7694625 1.94118125C-0.381978125 4.523578125 2.04541875 8.905621875 2.159634375 9.10915625C1.0598125 10.796428125 0.570884375 12.80939375 0.7741281250000001 14.81315625C1.01350625 17.918 3.6018125 21.30881875 6.715471875 21.30881875H16.533365625000002C19.647121875 21.30881875 22.236396875 17.918 22.474709375 14.81315625C22.680859375 12.808521875 22.192415625 10.793909374999998 21.0912375 9.106250000000001Z" stroke-width="0.75"></path><path fill="#ffdda1" stroke="#191919" stroke-linecap="round" stroke-linejoin="round" d="M19.074978125 15.846134374999998C19.074978125 9.917675000000001 14.976971875 12.338096875 11.62596875 12.338096875C8.27486875 12.338096875 4.1768625 9.9792875 4.1768625 15.846134374999998C4.1768625 17.766003124999997 5.733256249999999 19.322396875 7.653125 19.322396875H15.598812500000001C17.51868125 19.322396875 19.074978125 17.766003124999997 19.074978125 15.846134374999998H19.074978125Z" stroke-width="0.75"></path><path fill="#c77f67" stroke="#191919" stroke-linecap="round" stroke-linejoin="round" d="M15.123059375 17.335974999999998C15.671275 17.335974999999998 16.116221875 16.66850625 16.116221875 15.846134374999998S15.671275 14.35629375 15.123059375 14.35629375S14.1298 15.0237625 14.1298 15.846134374999998S14.574746875 17.335974999999998 15.123059375 17.335974999999998Z" stroke-width="0.75"></path><path fill="#c77f67" stroke="#191919" stroke-linecap="round" stroke-linejoin="round" d="M8.170534375 17.335974999999998C8.718846875 17.335974999999998 9.16379375 16.66850625 9.16379375 15.846134374999998S8.718846875 14.35629375 8.170534375 14.35629375S7.177371875 15.0237625 7.177371875 15.846134374999998S7.62231875 17.335974999999998 8.170534375 17.335974999999998Z" stroke-width="0.75"></path></svg>
                    GitHub</a>

                <div class="search-container">
                    <input id="search" type="search" placeholder="Search...">

                    <div class="search-results">
                        <div class="search-results__items"></div>
                    </div>
                </div>
            </nav>
        </header>
        <!--div style="background: #cc0000; color: #ffffff; padding: 1em;">
            This is a snapshot of the VMware Secrets Manager documentation
            at version <strong>v0.25.3</strong>.<br>
            For the latest information, please visit the
            <a href="/" style="color:#ffff00;text-decoration:underline;border:0"
            >VMware Secrets Manager documentation root</a>.
        </div-->
            <div style="font-size:1em;background:#FFED90;
            color: #000000;
padding: 1em;
">
                <svg
                    style="display:inline-block;top: 7px;position:relative;"
                    xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="-0.375 -0.375 24 24" id="Calendar-Favorite-1--Streamline-Ultimate" height="24" width="24"><desc>Calendar Favorite 1 Streamline Icon: https://streamlinehq.com</desc><path fill="#ff808c" d="M19.859375 7.273375V3.390625a0.96875 0.96875 0 0 0 -0.96875 -0.96875h-17.4375a0.96875 0.96875 0 0 0 -0.96875 0.96875v3.88275h19.375Z" stroke-width="0.75"></path><path fill="#ffbfc5" d="M19.859375 4.359375v-0.96875a0.96875 0.96875 0 0 0 -0.96875 -0.96875h-17.4375a0.96875 0.96875 0 0 0 -0.96875 0.96875v0.96875h19.375Z" stroke-width="0.75"></path><path fill="#ffffff" d="M0.484375 7.273375V16.953125a0.96875 0.96875 0 0 0 0.96875 0.96875h17.4375a0.96875 0.96875 0 0 0 0.96875 -0.96875v-9.6875l-19.375 0.00775Z" stroke-width="0.75"></path><path stroke="#191919" stroke-linecap="round" stroke-linejoin="round" d="M9.203125 17.921875h-7.75a0.96875 0.96875 0 0 1 -0.96875 -0.96875v-13.5625a0.96875 0.96875 0 0 1 0.96875 -0.96875h17.4375a0.96875 0.96875 0 0 1 0.96875 0.96875V9.6875" stroke-width="0.75"></path><path stroke="#191919" stroke-linecap="round" stroke-linejoin="round" d="M5.328125 0.48534375v4.84375" stroke-width="0.75"></path><path stroke="#191919" stroke-linecap="round" stroke-linejoin="round" d="M15.015625 0.48534375v4.84375" stroke-width="0.75"></path><path stroke="#191919" stroke-linecap="round" stroke-linejoin="round" d="M0.484375 7.26659375h19.375" stroke-width="0.75"></path><path fill="#ffef5e" d="m17.631249999999998 11.554281249999999 1.4909062499999999 3.4584375h2.9004375000000002a0.71203125 0.71203125 0 0 1 0.5018125 1.2429062499999999l-2.5187500000000003 2.2436249999999998 1.395 3.2085a0.76046875 0.76046875 0 0 1 -1.08209375 0.9513125L16.953125 20.7603125l-3.37125 1.89875a0.76046875 0.76046875 0 0 1 -1.08209375 -0.9513125l1.3969375 -3.204625 -2.5187500000000003 -2.2436249999999998a0.71203125 0.71203125 0 0 1 0.49793750000000003 -1.2429062499999999h2.90625l1.491875 -3.4584375a0.775 0.775 0 0 1 1.3659375 0l-0.0096875 -0.003875Z" stroke-width="0.75"></path><path fill="#fff9bf" d="M19.127 15.015625 17.631249999999998 11.554281249999999a0.775 0.775 0 0 0 -1.36496875 0L14.778281250000001 15.015625h-2.90625a0.71203125 0.71203125 0 0 0 -0.49793750000000003 1.2429062499999999l2.5187500000000003 2.24265625 -1.3920937500000001 3.2085a0.755625 0.755625 0 0 0 -0.0096875 0.5366875000000001l7.2365625 -7.2307500000000005h-0.600625Z" stroke-width="0.75"></path><path stroke="#191919" stroke-linecap="round" stroke-linejoin="round" d="m17.631249999999998 11.554281249999999 1.4909062499999999 3.4584375h2.9004375000000002a0.71203125 0.71203125 0 0 1 0.5018125 1.2429062499999999l-2.5187500000000003 2.2436249999999998 1.395 3.2085a0.76046875 0.76046875 0 0 1 -1.08209375 0.9513125L16.953125 20.7603125l-3.37125 1.89875a0.76046875 0.76046875 0 0 1 -1.08209375 -0.9513125l1.3969375 -3.204625 -2.5187500000000003 -2.2436249999999998a0.71203125 0.71203125 0 0 1 0.49793750000000003 -1.2429062499999999h2.90625l1.491875 -3.4584375a0.775 0.775 0 0 1 1.3659375 0l-0.0096875 -0.003875Z" stroke-width="0.75"></path></svg>
                &nbsp;<a style="color: #00151D" href="/community/contributor-hours/"><strong>Mark Your Calendars</strong></a>:
                The next
                <strong
                ><a
                    style="color: #FFE9BA;background: #08011C;padding: 0.2em;font-weight:400;margin:0.4em;position:relative;display:inline-block;transform: rotate(-2deg)"
                    href="/community/contributor-hours/"
                >VSecM Contributor Sync</a
                ></strong
                >
                will be on...
                <a
                    href="/community/contributor-hours/"
                    style="color: #FFE9BA;background: #08011C;padding: 0.2em;margin:0.4em;font-weight:400;position:relative;display:inline-block;transform: rotate(-2deg)"

                >ðŸŽƒ Thursday, 2024-10-31 ðŸŽƒ
                at 8:00am Pacific time</a>.

            </div>
        <div
        style="padding:1em;background:#DDC755;color:#000000"
        >
            <svg
                style="position:relative;top:6px;"
                xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="-0.375 -0.375 24 24" id="Rating-Star-1--Streamline-Ultimate" height="24" width="24"><desc>Rating Star 1 Streamline Icon: https://streamlinehq.com</desc><path fill="#ffef5e" d="M10.936896875 1.971503125C11.000059375000001 1.840915625 11.098871874999999 1.73076875 11.221903125 1.6537531250000002C11.34464375 1.5767375 11.486953125 1.53585625 11.631974999999999 1.53585625C11.776996875 1.53585625 11.919209375 1.5767375 12.042046875 1.6537531250000002C12.16498125 1.73076875 12.263890625 1.840915625 12.327053125 1.971503125L15.183025 7.745253125L21.583846875000003 8.671959375C21.726737500000002 8.692690625000001 21.860812499999998 8.75304375 21.97105625 8.8462375C22.081396875000003 8.939334375 22.163353125 9.061396875 22.207721875 9.198862499999999C22.252187499999998 9.336134375 22.257128125 9.483190624999999 22.222253124999998 9.623175C22.187378125 9.763256250000001 22.113850000000003 9.890646875 22.01019375 9.99110625L17.376371875 14.4704125L18.469896875 20.803325C18.494309375 20.945149999999998 18.478615625 21.090946875 18.424462499999997 21.22434375C18.370406250000002 21.35764375 18.28011875 21.473409375 18.163771875000002 21.558175C18.047618749999998 21.642940625 17.9098625 21.693509375 17.766390625 21.7042625C17.622821875 21.714918750000002 17.479253125 21.685468750000002 17.351571875 21.618915625L11.630424999999999 18.63158125L5.89833125 21.62656875C5.770746875 21.69321875 5.62708125 21.72266875 5.4836093749999995 21.7120125C5.3401375 21.701259375 5.202478125000001 21.650690625 5.08613125 21.565925C4.96988125 21.481159375 4.87959375 21.36539375 4.8255375 21.23209375C4.77148125 21.098696874999998 4.755690625 20.9529 4.780103125 20.811075L5.873725 14.4781625L1.23980625 9.998856250000001C1.13615 9.898396875000001 1.06271875 9.77100625 1.027746875 9.630925C0.992871875 9.490940625 0.9978125 9.343884375 1.04218125 9.2066125C1.086646875 9.069146875000001 1.168603125 8.947084375 1.2788468750000002 8.8539875C1.3891875 8.76079375 1.523359375 8.700440624999999 1.666153125 8.679709375L8.068525 7.753003125L10.936896875 1.971503125Z" stroke-width="0.75"></path><path fill="#fff9bf" d="M11.630424999999999 18.63158125L5.89833125 21.62656875C5.770746875 21.69321875 5.62708125 21.72266875 5.4836093749999995 21.7120125C5.3401375 21.701259375 5.202478125000001 21.650690625 5.08613125 21.565925C4.96988125 21.481159375 4.87959375 21.36539375 4.8255375 21.23209375C4.77148125 21.098696874999998 4.755690625 20.9529 4.780103125 20.811075L5.873725 14.4781625L1.23980625 9.998856250000001C1.13615 9.898396875000001 1.06271875 9.77100625 1.027746875 9.630925C0.992871875 9.490940625 0.9978125 9.343884375 1.04218125 9.2066125C1.086646875 9.069146875000001 1.168603125 8.947084375 1.2788468750000002 8.8539875C1.3891875 8.76079375 1.523359375 8.700440624999999 1.666153125 8.679709375L8.068525 7.753003125L10.932246875 1.9808031250000002C10.995215625 1.84915 11.09431875 1.73813125 11.217834375 1.660534375C11.341446875 1.582840625 11.484434375000001 1.5418625 11.630424999999999 1.542153125V18.63158125Z" stroke-width="0.75"></path><path stroke="#191919" stroke-linecap="round" stroke-linejoin="round" d="M10.936896875 1.971503125C11.000059375000001 1.840915625 11.098871874999999 1.73076875 11.221903125 1.6537531250000002C11.34464375 1.5767375 11.486953125 1.53585625 11.631974999999999 1.53585625C11.776996875 1.53585625 11.919209375 1.5767375 12.042046875 1.6537531250000002C12.16498125 1.73076875 12.263890625 1.840915625 12.327053125 1.971503125L15.183025 7.745253125L21.583846875000003 8.671959375C21.726737500000002 8.692690625000001 21.860812499999998 8.75304375 21.97105625 8.8462375C22.081396875000003 8.939334375 22.163353125 9.061396875 22.207721875 9.198862499999999C22.252187499999998 9.336134375 22.257128125 9.483190624999999 22.222253124999998 9.623175C22.187378125 9.763256250000001 22.113850000000003 9.890646875 22.01019375 9.99110625L17.376371875 14.4704125L18.469896875 20.803325C18.494309375 20.945149999999998 18.478615625 21.090946875 18.424462499999997 21.22434375C18.370406250000002 21.35764375 18.28011875 21.473409375 18.163771875000002 21.558175C18.047618749999998 21.642940625 17.9098625 21.693509375 17.766390625 21.7042625C17.622821875 21.714918750000002 17.479253125 21.685468750000002 17.351571875 21.618915625L11.630424999999999 18.63158125L5.89833125 21.62656875C5.770746875 21.69321875 5.62708125 21.72266875 5.4836093749999995 21.7120125C5.3401375 21.701259375 5.202478125000001 21.650690625 5.08613125 21.565925C4.96988125 21.481159375 4.87959375 21.36539375 4.8255375 21.23209375C4.77148125 21.098696874999998 4.755690625 20.9529 4.780103125 20.811075L5.873725 14.4781625L1.23980625 9.998856250000001C1.13615 9.898396875000001 1.06271875 9.77100625 1.027746875 9.630925C0.992871875 9.490940625 0.9978125 9.343884375 1.04218125 9.2066125C1.086646875 9.069146875000001 1.168603125 8.947084375 1.2788468750000002 8.8539875C1.3891875 8.76079375 1.523359375 8.700440624999999 1.666153125 8.679709375L8.068525 7.753003125L10.936896875 1.971503125Z" stroke-width="0.75"></path></svg>

            &nbsp;<a href="https://github.com/vmware-tanzu/secrets-manager" style="color:#000000;text-decoration:underline;">Star <strong>VMware Secrets Manager</strong> to show your support</a>.
            <span class="secondary-slogan">Help us reach out to even more people with this amazing tech.</span></div>

        <div class="content content--reversed">
            



<div class="documentation">
    <aside class="documentation__sidebar">
        <ul>
            
            
            <li>
                <span class="documentation__sidebar__title"></span>
                <ul>
                    
                </ul>
            </li>
            
            
            <li>
                <span class="documentation__sidebar__title">Community</span>
                <ul>
                    
                    <li class="">
                        <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;community&#x2F;hello&#x2F;">VSecM Community</a>
                    </li>
                    
                    <li class="">
                        <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;community&#x2F;contributor-hours&#x2F;">VSecM Contributor Hour</a>
                    </li>
                    
                    <li class="">
                        <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;community&#x2F;contact&#x2F;">Get in Touch</a>
                    </li>
                    
                    <li class="">
                        <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;community&#x2F;maintainers&#x2F;">Maintainers</a>
                    </li>
                    
                    <li class="">
                        <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;community&#x2F;endorsements&#x2F;">What People Say</a>
                    </li>
                    
                </ul>
            </li>
            
            
            <li>
                <span class="documentation__sidebar__title">Showcase</span>
                <ul>
                    
                    <li class="">
                        <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;showcase&#x2F;vsecm&#x2F;">VSecM Showcase</a>
                    </li>
                    
                </ul>
            </li>
            
            
            <li>
                <span class="documentation__sidebar__title">Timeline</span>
                <ul>
                    
                    <li class="">
                        <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;timeline&#x2F;roadmap&#x2F;">VSecM Roadmap</a>
                    </li>
                    
                    <li class="">
                        <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;timeline&#x2F;changelog&#x2F;">VSecM Changelog</a>
                    </li>
                    
                </ul>
            </li>
            

        
            
            <li>
                <span class="documentation__sidebar__title">Quickstart</span>
                <ul>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;getting-started&#x2F;overview&#x2F;">Prerequisites</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;getting-started&#x2F;installation&#x2F;">Installation</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;getting-started&#x2F;verify&#x2F;">Verify Installation</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;getting-started&#x2F;deploy&#x2F;">Deploy an Example Workload</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;getting-started&#x2F;register&#x2F;">Register a Secret</a>
                        </li>
                    
                </ul>
            </li>
        
            
            <li>
                <span class="documentation__sidebar__title">Welcome</span>
                <ul>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;welcome&#x2F;overview&#x2F;">Introducing VSecM</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;welcome&#x2F;about&#x2F;">What is VSecM</a>
                        </li>
                    
                </ul>
            </li>
        
            
            <li>
                <span class="documentation__sidebar__title">Architecture</span>
                <ul>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;architecture&#x2F;philosophy&#x2F;">VSecM Design Philosophy</a>
                        </li>
                    
                        <li class="active">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;architecture&#x2F;overview&#x2F;">VSecM Architecture</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;architecture&#x2F;adr-intro&#x2F;">Architectural Decision Records</a>
                        </li>
                    
                </ul>
            </li>
        
            
            <li>
                <span class="documentation__sidebar__title">Configuration</span>
                <ul>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;configuration&#x2F;overview&#x2F;">Configuring VSecM</a>
                        </li>
                    
                </ul>
            </li>
        
            
            <li>
                <span class="documentation__sidebar__title">Development</span>
                <ul>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;development&#x2F;use-the-source&#x2F;">Use the Source</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;development&#x2F;contributing&#x2F;">Contribute to VSecM</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;development&#x2F;dev-env&#x2F;">Development Environment</a>
                        </li>
                    
                </ul>
            </li>
        
            
            <li>
                <span class="documentation__sidebar__title">Using VSecM</span>
                <ul>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;usage&#x2F;installation&#x2F;">Installation</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;usage&#x2F;cli&#x2F;">VSecM CLI</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;usage&#x2F;sdk&#x2F;">VSecM SDK</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;usage&#x2F;releases&#x2F;">VSecM Releases</a>
                        </li>
                    
                </ul>
            </li>
        
            
            <li>
                <span class="documentation__sidebar__title">Use Cases</span>
                <ul>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;use-cases&#x2F;about&#x2F;">About Use Cases</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;use-cases&#x2F;overview&#x2F;">Overview</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;use-cases&#x2F;registering-secrets&#x2F;">Registering Secrets</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;use-cases&#x2F;retrieving-secrets&#x2F;">Retrieving Secrets</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;use-cases&#x2F;sidecar&#x2F;">Using VSecM Sidecar</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;use-cases&#x2F;init-container&#x2F;">Using VSecM Init Container</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;use-cases&#x2F;encrypt&#x2F;">Encrypting Secrets Using VSecM</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;use-cases&#x2F;transform&#x2F;">Transforming Secrets</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;use-cases&#x2F;mounting-secrets&#x2F;">Mounting Secrets as Volumes</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;use-cases&#x2F;template-files&#x2F;">Mutating a Template File</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;use-cases&#x2F;vsecm-sdk&#x2F;">Retrieving Secrets Via VSecM SDK</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;use-cases&#x2F;kubernetes-secrets&#x2F;">Mounting Kubernetes Secrets</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;use-cases&#x2F;large-files&#x2F;">Encrypting Large Files</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;use-cases&#x2F;root-key&#x2F;">Setting VSecM Root Key</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;use-cases&#x2F;randomized-secrets&#x2F;">Generating Randomized Secrets</a>
                        </li>
                    
                </ul>
            </li>
        
            
            <li>
                <span class="documentation__sidebar__title">Production</span>
                <ul>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;production&#x2F;overview&#x2F;">Production Setup</a>
                        </li>
                    
                </ul>
            </li>
        
            
            <li>
                <span class="documentation__sidebar__title">Operations</span>
                <ul>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;operations&#x2F;security&#x2F;">Security</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;operations&#x2F;documentation-snapshots&#x2F;">Documentation Snapshots</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;operations&#x2F;release-management&#x2F;">Release Management</a>
                        </li>
                    
                        <li class="">
                            <a href="https:&#x2F;&#x2F;vsecm.com&#x2F;documentation&#x2F;operations&#x2F;governance&#x2F;">Governance</a>
                        </li>
                    
                </ul>
            </li>
        
        </ul>
    </aside>
    <div class="documentation__content">
        
    <h1>VSecM Architecture</h1>
    <h2 id="introduction">
<a class="zola-anchor" href="#introduction" aria-label="Anchor link for: introduction" style="position:relative; top: -4px;">
  <img src="https://vsecm.com/vsecm-32.png" alt="Link" style="vertical-align:middle">
</a>Introduction</h2>
<p>This section discusses <strong>VMware Secrets Manager</strong> architecture and building blocks
in greater detail: We will cover <strong>VMware Secrets Manager</strong>â€™s system design and
project structure.</p>
<p>You donâ€™t have to know about these architectural details to use <strong>VMware Secrets Manager</strong>;
however, understanding how <strong>VMware Secrets Manager</strong> works as a system can
prove helpful when you want to extend, augment, or optimize <strong>VMware Secrets Manager</strong>.</p>
<p>Also, if you want to <a href="https://vsecm.com/documentation/development/contributing/" title="Contribute to VMware Secrets Manager">contribute to the <strong>VMware Secrets Manager</strong> source code</a>,
knowing what happens under the hood will serve you well.</p>
<h2 id="components-of-vmware-secrets-manager">
<a class="zola-anchor" href="#components-of-vmware-secrets-manager" aria-label="Anchor link for: components-of-vmware-secrets-manager" style="position:relative; top: -4px;">
  <img src="https://vsecm.com/vsecm-32.png" alt="Link" style="vertical-align:middle">
</a>Components of VMware Secrets Manager</h2>
<p><strong>VMware Secrets Manager</strong> (<em>VSecM</em>), as a system, has the following components.</p>
<h3 id="spire">
<a class="zola-anchor" href="#spire" aria-label="Anchor link for: spire" style="position:relative; top: -4px;">
  <img src="https://vsecm.com/vsecm-32.png" alt="Link" style="vertical-align:middle">
</a>SPIRE</h3>
<p><a href="https://spiffe.io/"><strong>SPIRE</strong></a> is not strictly a part of <strong>VMware Secrets Manager</strong>. However,
<strong>VMware Secrets Manager</strong> uses <strong>SPIRE</strong> to establish an <em>Identity Control Plane</em>.</p>
<p><strong>SPIRE</strong> is what makes communication within <strong>VMware Secrets Manager</strong>
components and workloads possible. It dispatches <strong>x.509 SVID Certificates</strong>
to the required parties to make secure <strong>mTLS</strong> communication possible.</p>
<p><a href="https://spiffe.io/">Check out the official SPIFFE/SPIRE documentation</a> for more information
about how <strong>SPIRE</strong> works internally.</p>
<blockquote>
<p><strong>It Is More SPIFFE than SPIRE</strong></p>
<p>Technically, any SPIFFE-compatible Identity Control Plane can be used with
<strong>VMware Secrets Manager</strong>. However, only <strong>SPIRE</strong> comes as part of the
default installation.</p>
</blockquote>
<h3 id="vsecm-safe">
<a class="zola-anchor" href="#vsecm-safe" aria-label="Anchor link for: vsecm-safe" style="position:relative; top: -4px;">
  <img src="https://vsecm.com/vsecm-32.png" alt="Link" style="vertical-align:middle">
</a>VSecM Safe</h3>
<p><a href="https://github.com/vmware-tanzu/secrets-manager/tree/main/app/safe"><code>vsecm-safe</code></a> stores secrets and dispatches them to workloads.</p>
<h3 id="vsecm-sidecar">
<a class="zola-anchor" href="#vsecm-sidecar" aria-label="Anchor link for: vsecm-sidecar" style="position:relative; top: -4px;">
  <img src="https://vsecm.com/vsecm-32.png" alt="Link" style="vertical-align:middle">
</a>VSecM Sidecar</h3>
<p><a href="https://github.com/vmware-tanzu/secrets-manager/tree/main/app/sidecar"><code>vsecm-sidecar</code></a> is a sidecar that facilitates delivering secrets to
workloads.</p>
<h3 id="vsecm-sentinel">
<a class="zola-anchor" href="#vsecm-sentinel" aria-label="Anchor link for: vsecm-sentinel" style="position:relative; top: -4px;">
  <img src="https://vsecm.com/vsecm-32.png" alt="Link" style="vertical-align:middle">
</a>VSecM Sentinel</h3>
<p><a href="https://github.com/vmware-tanzu/secrets-manager/tree/main/app/sentinel"><code>vsecm-sentinel</code></a> is a pod you can shell in and do administrative
tasks such as registering secrets for workloads.</p>
<p>Here is a simplified overview of how various actors on a
<strong>VMware Secrets Manager</strong> system interact with each other:</p>
<p><img src="/assets/actors.jpg" alt="VMware Secrets Manager Components" title="VMware Secrets Manager Component Interaction" /></p>
<h3 id="vsecm-keygen">
<a class="zola-anchor" href="#vsecm-keygen" aria-label="Anchor link for: vsecm-keygen" style="position:relative; top: -4px;">
  <img src="https://vsecm.com/vsecm-32.png" alt="Link" style="vertical-align:middle">
</a>VSecM Keygen</h3>
<p><a href="https://github.com/vmware-tanzu/secrets-manager/tree/main/app/keygen"><code>vsecm-keygen</code></a> is a utility that generates the root key that
<strong>VSecM Safe</strong> uses, if manual input mode is set. By default, <strong>VSecM Safe</strong>
generates the root key automatically; however, you can opt out from this
if you want to control the root key yourself and provide your own key.</p>
<p>You can check out the <a href="https://vsecm.com/documentation/usage/cli/">CLI documentation</a> for more information
about how to use <strong>VSecM Keygen</strong>.</p>
<p>You can also use <strong>VSecM Keygen</strong> to decrypt secrets that <strong>VSecM Safe</strong> stores.
This will require you to provide the root key that <strong>VSecM Safe</strong> uses.
Again, can check out the <a href="https://vsecm.com/documentation/usage/cli/">CLI documentation</a> for more information.</p>
<h3 id="vsecm-keystone">
<a class="zola-anchor" href="#vsecm-keystone" aria-label="Anchor link for: vsecm-keystone" style="position:relative; top: -4px;">
  <img src="https://vsecm.com/vsecm-32.png" alt="Link" style="vertical-align:middle">
</a>VSecM Keystone</h3>
<p><code>vsecm-keystone</code> is a component that leverages <strong>VSecM Init Container</strong>
behind the scenes.</p>
<p>When the entire <strong>VSecM</strong> system finishes bootstrapping, and it is ready
for operation, <strong>VSecM Keystone</strong> will be in a <code>Ready</code> state.</p>
<p>This is useful when you want to configure your orchestrator to wait until
<strong>VSecM</strong> is ready before starting your workloads.</p>
<p><strong>VSecM Keystone</strong> is an optional component and it may be disabled if you
do not need it.</p>
<h3 id="vsecm-init-container">
<a class="zola-anchor" href="#vsecm-init-container" aria-label="Anchor link for: vsecm-init-container" style="position:relative; top: -4px;">
  <img src="https://vsecm.com/vsecm-32.png" alt="Link" style="vertical-align:middle">
</a>VSecM Init Container</h3>
<p><code>vsecm-init-container</code> is a sidecar that you can add to a workload to let
it wait until a secrets is registered for it in <strong>VSecM Safe</strong>.</p>
<p>This is useful for use cases where you want to make sure that a workload
does not initialize without the required secrets.</p>
<p><a href="https://vsecm.com/documentation/use-cases/overview/">You can check out the use cases section for more information</a>.</p>
<blockquote>
<p><strong>VSecM Init Container and VSecM Sidecar Coordination</strong></p>
<p><strong>VSecM Init Container</strong> and <strong>VSecM Sidecar</strong> can be used in coordination
with each other, each serving its own purpose.</p>
<p>In that case, <strong>VSecM Sidecar</strong> will pre-populate the secret data
inside an in-memory volume, while <strong>VSecM Init Container</strong> will wait
until the secret is available before starting the application.</p>
</blockquote>
<h3 id="vsecm-inspector">
<a class="zola-anchor" href="#vsecm-inspector" aria-label="Anchor link for: vsecm-inspector" style="position:relative; top: -4px;">
  <img src="https://vsecm.com/vsecm-32.png" alt="Link" style="vertical-align:middle">
</a>VSecM Inspector</h3>
<p><strong>VSecM Inspector</strong> is a sample application that has an <code>./env</code> executable
at the root of it where you can shell into it and execute <code>./env</code> to
see the secrets that <strong>VSecM Safe</strong> injects to it.</p>
<p>This is useful for debugging and testing purposes.</p>
<h2 id="high-level-architecture">
<a class="zola-anchor" href="#high-level-architecture" aria-label="Anchor link for: high-level-architecture" style="position:relative; top: -4px;">
  <img src="https://vsecm.com/vsecm-32.png" alt="Link" style="vertical-align:middle">
</a>High-Level Architecture</h2>
<h3 id="dispatching-identities">
<a class="zola-anchor" href="#dispatching-identities" aria-label="Anchor link for: dispatching-identities" style="position:relative; top: -4px;">
  <img src="https://vsecm.com/vsecm-32.png" alt="Link" style="vertical-align:middle">
</a>Dispatching Identities</h3>
<p><strong>SPIRE</strong> delivers short-lived <a href="https://spiffe.io/docs/latest/deploying/svids/">X.509 SVIDs</a> to <strong>VMware Secrets Manager</strong>
components and consumer workloads.</p>
<p><strong>VSecM Sidecar</strong> periodically talks to <strong>VSecM Safe</strong> to check if there is
a new secret to be updated.</p>
<p>Open the image above in a new tab or window to see it in full size:</p>
<p><img src="/assets/vsecm-sidecar.png" alt="VMware Secrets Manager Sidecar" title="VMware Secrets Manager Sidecar" /></p>
<p>Alternatively, you can use <strong>VSecM SDK</strong> to retrieve secrets from <strong>VSecM Safe</strong>
programmatically:</p>
<p><img src="/assets/vsecm-sdk.png" alt="Using VSecM SDK" title="Using VSecM SDK" /></p>
<h3 id="creating-secrets">
<a class="zola-anchor" href="#creating-secrets" aria-label="Anchor link for: creating-secrets" style="position:relative; top: -4px;">
  <img src="https://vsecm.com/vsecm-32.png" alt="Link" style="vertical-align:middle">
</a>Creating Secrets</h3>
<p><strong>VSecM Sentinel</strong> is the only place where secrets can be created and registered
to <strong>VSecM Safe</strong>.</p>
<p><img src="/assets/vsecm-create-secrets.png" alt="Creating Secrets" title="Creating Secrets" /></p>
<h3 id="component-and-workload-spiffe-id-schemas">
<a class="zola-anchor" href="#component-and-workload-spiffe-id-schemas" aria-label="Anchor link for: component-and-workload-spiffe-id-schemas" style="position:relative; top: -4px;">
  <img src="https://vsecm.com/vsecm-32.png" alt="Link" style="vertical-align:middle">
</a>Component and Workload SPIFFE ID Schemas</h3>
<p>SPIFFE ID format for workloads is as follows:</p>
<pre data-lang="txt" style="background-color:#2e3440;color:#d8dee9;" class="language-txt "><code class="language-txt" data-lang="txt"><span>spiffe://vsecm.com/workload/$workloadName
</span><span>  /ns/{{ .PodMeta.Namespace }}
</span><span>  /sa/{{ .PodSpec.ServiceAccountName }}
</span><span>  /n/{{ .PodMeta.Name }}
</span></code></pre>
<p>For the non-<code>vsecm-system</code> workloads that <strong>Safe</strong> injects secrets,
<code>$workloadName</code> is determined by the workloadâ€™s <code>ClusterSPIFFEID</code> CRD.</p>
<p>For <code>vsecm-system</code> components, we use <code>vsecm-safe</code> and <code>vsecm-sentinel</code>
for the <code>$workloadName</code> (<em>along with other attestors such as attesting
the service account and namespace</em>):</p>
<pre data-lang="txt" style="background-color:#2e3440;color:#d8dee9;" class="language-txt "><code class="language-txt" data-lang="txt"><span>spiffe://vsecm.com/workload/vsecm-safe
</span><span>  /ns/{{ .PodMeta.Namespace }}
</span><span>  /sa/{{ .PodSpec.ServiceAccountName }}
</span><span>  /n/{{ .PodMeta.Name }}
</span></code></pre>
<pre data-lang="txt" style="background-color:#2e3440;color:#d8dee9;" class="language-txt "><code class="language-txt" data-lang="txt"><span>spiffe://vsecm.com/workload/vsecm-sentinel
</span><span>  /ns/{{ .PodMeta.Namespace }}
</span><span>  /sa/{{ .PodSpec.ServiceAccountName }}
</span><span>  /n/{{ .PodMeta.Name }}
</span></code></pre>
<blockquote>
<p><strong>You Can Have Custom SPIFFE ID Formats</strong></p>
<p>You can configure your <strong>VSecM</strong> installation to use custom SPIFFE ID
formats and RegExp-based validation rules. Check out the 
<a href="https://vsecm.com/documentation/configuration/overview/"><strong>Configuration</strong></a> section
for more details.</p>
</blockquote>
<h2 id="a-note-on-spire-controller-manager-and-clusterspiffeids">
<a class="zola-anchor" href="#a-note-on-spire-controller-manager-and-clusterspiffeids" aria-label="Anchor link for: a-note-on-spire-controller-manager-and-clusterspiffeids" style="position:relative; top: -4px;">
  <img src="https://vsecm.com/vsecm-32.png" alt="Link" style="vertical-align:middle">
</a>A Note on SPIRE Controller Manager and ClusterSPIFFEIDs</h2>
<p><strong>VSecM</strong> uses <strong>SPIRE</strong> to establish an Identity Control Plane.
And <strong>SPIRE</strong> uses <a href="https://github.com/spiffe/spire-controller-manager"><strong>SPIRE Controller Manager</strong></a> to manage the 
<strong>SPIRE Server</strong> and <strong>SPIRE Agent</strong>. <a href="https://github.com/spiffe/spire-controller-manager"><strong>SPIRE Controller Manager</strong></a> 
uses <a href="https://github.com/spiffe/spire-controller-manager/blob/main/docs/clusterspiffeid-crd.md"><strong>ClusterSPIFFEIDs</strong></a> to assign and determine SVIDs 
for workloads.</p>
<p>What this means for <strong>VSecM</strong> is that to assign identities to your workloads,
you need to create <strong>ClusterSPIFFEIDs</strong> for them.</p>
<p>Here is an example:</p>
<pre data-lang="yaml" style="background-color:#2e3440;color:#d8dee9;" class="language-yaml "><code class="language-yaml" data-lang="yaml"><span style="color:#8fbcbb;">apiVersion</span><span style="color:#eceff4;">: </span><span style="color:#a3be8c;">spire.spiffe.io/v1alpha1
</span><span style="color:#8fbcbb;">kind</span><span style="color:#eceff4;">: </span><span style="color:#a3be8c;">ClusterSPIFFEID
</span><span style="color:#8fbcbb;">metadata</span><span style="color:#eceff4;">:
</span><span>  </span><span style="color:#8fbcbb;">name</span><span style="color:#eceff4;">: </span><span style="color:#a3be8c;">example-workload
</span><span style="color:#8fbcbb;">spec</span><span style="color:#eceff4;">:
</span><span>  </span><span style="color:#8fbcbb;">className</span><span style="color:#eceff4;">: </span><span style="color:#a3be8c;">&quot;vsecm&quot;
</span><span>  </span><span style="color:#8fbcbb;">spiffeIDTemplate</span><span style="color:#eceff4;">: </span><span style="color:#a3be8c;">&quot;spiffe://vsecm.com</span><span style="color:#ebcb8b;">\
</span><span style="color:#a3be8c;">    /workload/example</span><span style="color:#ebcb8b;">\
</span><span style="color:#a3be8c;">    /ns/default</span><span style="color:#ebcb8b;">\
</span><span style="color:#a3be8c;">    /sa/example</span><span style="color:#ebcb8b;">\
</span><span style="color:#a3be8c;">    /n/{{ .PodMeta.Name }}&quot;
</span><span>  </span><span style="color:#8fbcbb;">podSelector</span><span style="color:#eceff4;">:
</span><span>    </span><span style="color:#8fbcbb;">matchLabels</span><span style="color:#eceff4;">:
</span><span>      </span><span style="color:#8fbcbb;">app.kubernetes.io/name</span><span style="color:#eceff4;">: </span><span style="color:#a3be8c;">example-workload
</span><span>  </span><span style="color:#8fbcbb;">workloadSelectorTemplates</span><span style="color:#eceff4;">:
</span><span>  - </span><span style="color:#a3be8c;">&quot;k8s:ns:default&quot;
</span><span>  - </span><span style="color:#a3be8c;">&quot;k8s:sa:example-workload-sa&quot;
</span></code></pre>
<p>This <strong>ClusterSPIFFEID</strong> will assign the following SPIFFE ID to the workloads
that are in the <code>default</code> namespace, have the 
<code>app.kubernetes.io/name: example-workload</code>label, and use 
the <code>example-workload-sa</code> service account.</p>
<p>Unless you are using a custom configuration for <strong>VSecM</strong> ClusterSPIFFEIDs,
the <code>className</code> field should be set to <code>vsecm</code> and the <code>spiifeIDTemplate</code>
should start wih <code>spiffe://vsecm.com/workload/</code> followed by the name you give
to the workload.</p>
<p>You can check out the <a href="https://vsecm.com/documentation/getting-started/overview/"><strong>VSecM</strong> quick start guide</a> for more 
information on how to create <strong>ClusterSPIFFEIDs</strong> for your workloads.</p>
<p>One additional thing to note about <strong>SPIRE Controller Manager</strong> is that it
takes ownership of all <strong>SPIRE</strong> entries by default. This means that if you
manually create an entry using <strong>SPIRE Server</strong>â€™s CLI, 
<strong>SPIRE Controller Manager</strong> will override it and reflect its own state that
are defined in the <strong>ClusterSPIFFEIDs</strong>. </p>
<p>This essentially means that the <strong>ClusterSPIFFEIDs</strong> are the source of truth 
for identities in <strong>SPIRE</strong> and therefore in <strong>VSecM</strong>.</p>
<blockquote>
<p><strong>Can I Have My Own SPIRE Server Entries</strong>?</p>
<p>If you want to register your own <strong>SPIRE Server</strong> entries, you will need 
a custom SPIRE deployment that does not use SPIRE Controller Manager.</p>
<p><strong>VMware Secrets Manager</strong> can work with any SPIFFE-compatible Identity
Control Plane, so you can use your own SPIRE deployment if you want to.</p>
<p>However, using <code>ClusterSPIFFEID</code>s is the recommended way to assign identities 
to your workloads in <strong>VSecM</strong>. They are easier to manage and maintain because
they are Kubernetes CRDs and use the declarative nature of Kubernetes.</p>
</blockquote>
<h2 id="persisting-secrets">
<a class="zola-anchor" href="#persisting-secrets" aria-label="Anchor link for: persisting-secrets" style="position:relative; top: -4px;">
  <img src="https://vsecm.com/vsecm-32.png" alt="Link" style="vertical-align:middle">
</a>Persisting Secrets</h2>
<p><strong>VSecM Safe</strong> uses <a href="https://github.com/FiloSottile/age"><code>age</code></a> encryption by default to securely persist the
secrets to disk so that when its Pod is replaced by another Pod for any reason
(<em>eviction, crash, system restart, etc.</em>) it can retrieve secrets from a
persistent storage.</p>
<blockquote>
<p><strong>You Can Swap the Encryption Mechanism</strong></p>
<p>In <strong>FIPS-compliant</strong> environments, you can use <strong>VMware Secrets Manager</strong>
FIPS-compliant container images that use <strong>AES-256-GCM</strong> encryption instead
of <strong>Age</strong>.</p>
<p>Check out the <a href="https://vsecm.com/documentation/configuration/overview/"><strong>Configuration</strong></a> 
section for more details.</p>
<p>Also, you can opt out from auto-generating the private and public keys
and provide your own keys. However, when you do this, you will have to
manually unlock <strong>VSecM Safe</strong> by providing your keys every time it
crashes. If you let <strong>VSecM Safe</strong> auto-generate the keys,
you wonâ€™t have to do this; so you can <code>#sleepmore</code>.</p>
<p>Again, check out the <a href="https://vsecm.com/documentation/configuration/overview/"><strong>Configuration</strong></a>
section for more details.</p>
</blockquote>
<p>Since decryption is relatively expensive, once a secret is retrieved,
it is kept in memory and served from memory for better performance.
Unfortunately, this also means the amount of secrets you have for all
your workloads <strong>has to</strong> fit in the memory you allocate to <strong>VSecM Safe</strong>.</p>
<h2 id="bootstrapping-flow-of-vsecm-safe">
<a class="zola-anchor" href="#bootstrapping-flow-of-vsecm-safe" aria-label="Anchor link for: bootstrapping-flow-of-vsecm-safe" style="position:relative; top: -4px;">
  <img src="https://vsecm.com/vsecm-32.png" alt="Link" style="vertical-align:middle">
</a>Bootstrapping Flow of <strong>VSecM Safe</strong></h2>
<p>To persist secrets, <strong>VSecM Safe</strong> needs a way to generate and securely store
the initial cryptographic keys that are utilized for decrypting and encrypting
the secrets, respectively. After generation, the keys are stored in a Kubernetes
<code>Secret</code> that only <strong>VSecM Safe</strong> can access.</p>
<p>Here is a sequence diagram of the <strong>VSecM Safe</strong> bootstrapping flow:</p>
<p><img src="/assets/vsecm-bootstrap.png" alt="VSecM Safe Bootstrapping" title="VSecM Safe Bootstrapping Flow" /></p>
<p>Note that, until bootstrapping is complete, <strong>VSecM Safe</strong> will not respond to
any API requests that you make from <strong>VSecM Sentinel</strong>.</p>
<p>Here is a simplified version of the bootstrapping flow without taking the
â€œmanual key inputâ€ option into account:</p>
<p><img src="/assets/vsecm-bootstrap-simplified.png" alt="VSecM Safe Bootstrapping" title="VSecM Safe Bootstrapping Flow (Simplified)" /></p>
<h2 id="vsecm-safe-pod-layout">
<a class="zola-anchor" href="#vsecm-safe-pod-layout" aria-label="Anchor link for: vsecm-safe-pod-layout" style="position:relative; top: -4px;">
  <img src="https://vsecm.com/vsecm-32.png" alt="Link" style="vertical-align:middle">
</a><strong>VSecM Safe</strong> Pod Layout</h2>
<p>Here is what an <strong>VSecM Safe</strong> Pod looks like at a high level:</p>
<p><img src="/assets/vsecm-crypto.jpg" alt="VSedM Safe Pod" title="VSecM Safe Pod" /></p>
<ul>
<li><code>spire-agent-socket</code>: Is a <a href="https://github.com/spiffe/spiffe-csi">SPIFFE CSI Driver</a>-managed volume that
enables <strong>SPIRE</strong> to distribute <strong>X.509 SVID</strong>s to the Pod.</li>
<li><code>/data</code> is the volume where secrets are stored in an encrypted format. You are
<strong>strongly encouraged</strong> to use a <strong>persistent volume</strong> for production setups
to retrieve the secrets if the Pod crashes and restarts.</li>
<li><code>/key</code> is where the secret <code>vsecm-root-key</code> mounts. For security reasons,
ensure that <strong>only</strong> the pod <strong>VSecM Safe</strong> can read and write to <code>vsecm-root-key</code>
and no one else has access. In this diagram, this is achieved by assigning
a <code>vsecm-secret-readwriter</code> role to <strong>VSecM Safe</strong> and using that role to update
the secret. Any pod that does not have the role will be unable to read or
write to this secret.</li>
</ul>
<p>If the <code>main</code> container does not have a public/private key pair in memory, it
will attempt to retrieve it from the <code>/key</code> volume. If that fails, it will
generate a brand new key pair and then store it in the <code>vsecm-root-key</code> secret.</p>
<h2 id="template-transformation-and-kubernetes-secret-generation">
<a class="zola-anchor" href="#template-transformation-and-kubernetes-secret-generation" aria-label="Anchor link for: template-transformation-and-kubernetes-secret-generation" style="position:relative; top: -4px;">
  <img src="https://vsecm.com/vsecm-32.png" alt="Link" style="vertical-align:middle">
</a>Template Transformation and Kubernetes Secret Generation</h2>
<p><strong>VSecM</strong> enables you to transform the secrets you register with <strong>VSecM Safe</strong>
using Go template transformations before storing them. This is useful when
you want to store a secret in a format that is different from the format
you want to use in your workloads.</p>
<p>You can also prefix <code>k8s:</code> to the name of the workload to create a Kubernetes
<code>Secret</code> object with the transformed secret. This is useful when you want to
inject the secret to a workload using a Kubernetes <code>Secret</code> object instead
of <strong>VSecM Sidecar</strong> or <strong>VSecM SDK</strong>.</p>
<p>Check out the <a href="https://github.com/vmware-tanzu/secrets-manager/tree/main/examples" title="VSecM Examples">examples folder</a> for examples of how to use
<strong>VSecM</strong> to transform secrets and generate <strong>Kubernetes</strong> <code>Secret</code> objects.</p>
<h2 id="liveness-and-readiness-probes">
<a class="zola-anchor" href="#liveness-and-readiness-probes" aria-label="Anchor link for: liveness-and-readiness-probes" style="position:relative; top: -4px;">
  <img src="https://vsecm.com/vsecm-32.png" alt="Link" style="vertical-align:middle">
</a>Liveness and Readiness Probes</h2>
<p><strong>VSecM Safe</strong> and <strong>VSecM Sentinel</strong> use <strong>liveness</strong> and <strong>readiness</strong> probes.
These probes are tiny web servers that serve at ports <code>8081</code> and <code>8082</code> by
default, respectively.</p>
<p>You can set <code>VSECM_PROBE_LIVENESS_PORT</code> (<em>default <code>:8081</code></em>) and
<code>VSECM_PROBE_READINESS_PORT</code> (<em>default <code>:8082</code></em>) environment variables to change
the ports used for these probes.</p>
<p>When the service is healthy, the liveness probe will return an <code>HTTP 200</code> success
response. When the service is ready to receive traffic, the readiness
probe will return an <code>HTTP 200</code> success response.</p>
<h2 id="vsecm-and-spire-deployment-diagram">
<a class="zola-anchor" href="#vsecm-and-spire-deployment-diagram" aria-label="Anchor link for: vsecm-and-spire-deployment-diagram" style="position:relative; top: -4px;">
  <img src="https://vsecm.com/vsecm-32.png" alt="Link" style="vertical-align:middle">
</a><strong>VSecM</strong> and SPIRE Deployment Diagram</h2>
<p>Here is a different look at how <strong>VSecM</strong> and <strong>SPIRE</strong> components are deployed
in a Kubernetes cluster, focusing on the Services exposed by the components and
volumes mounted to the Pods.</p>
<p>Open the image in a new tab to see it in full size:</p>
<p><img src="/assets/vsecm-infra.png" alt="VSecM and SPIRE Deployment" title="VSecM and SPIRE Deployment Diagram" /></p>
<h2 id="conclusion">
<a class="zola-anchor" href="#conclusion" aria-label="Anchor link for: conclusion" style="position:relative; top: -4px;">
  <img src="https://vsecm.com/vsecm-32.png" alt="Link" style="vertical-align:middle">
</a>Conclusion</h2>
<p>This was a deeper overview of <strong>VMware Secrets Manager</strong> architecture. If you
have further questions, feel free to <a href="https://join.slack.com/t/a-101-103-105-s/shared_invite/zt-287dbddk7-GCX495NK~FwO3bh_DAMAtQ" title="Join VSecM Slack">join the <strong>VMware Secrets Manager</strong>
community on <strong>Slack</strong></a> and ask them out.</p>
<!--
# /*
# |    Protect your secrets, protect your sensitive data.
# :    Explore VMware Secrets Manager docs at https://vsecm.com/
# </
# <>/  keep your secrets... secret
# >/
# <>/' Copyright 2023-present VMware Secrets Manager contributors.
# >/'  SPDX-License-Identifier: BSD-2-Clause
# */
-->
<p class="github-button" style="text-align: right;margin-top:2em;border-top:1px #ccc dashed;padding-top:2em;">
  <a href="https://github.com/vmware-tanzu/secrets-manager/blob/main/docs/">
    edit this page âœï¸ 
  </a>
</p>


    </div>
</div>

        </div>
        <footer style="background:#00151D;">
            Copyright Â© 2023-present <a style="color:#95e2fc" href="https://github.com/vmware-tanzu/secrets-manager/graphs/contributors">VMware Secrets Manager contributors</a>.<br><br>
            <strong>VMware Secrets Manager</strong> for Cloud-Native Apps<br>
            code is distributed under <a style="color:#95e2fc"  href="https://github.com/vmware-tanzu/secrets-manager/blob/main/LICENSE">BSD 2-Clause License</a>.<br>
            <br>
            The documentation on this website<br>
            is distributed under <a style="color:#95e2fc"  href="https://creativecommons.org/licenses/by/4.0/">CC-BY-4.0</a>.
            <br><br>
            <a style="color:#95e2fc" href="/community/contact/">contact</a> |
            <a style="color:#95e2fc" href="/privacy/">privacy policy</a> |
            <a style="color:#95e2fc" href="/code-of-conduct">code of conduct</a>
            <br><br>
        </footer>

        <script type="text/javascript" src="https://vsecm.com/elasticlunr.min.js"></script>
        <script type="text/javascript" src="https://vsecm.com/search.js"></script>
    </body>
</html>
